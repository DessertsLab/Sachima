{"version":3,"sources":["packages/superset-ui-legacy-plugin-chart-api-table/src/vis/Funnel.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/BarRace/Bar.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/BarRace/BarChart.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/BarRace/data.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/BarRace.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/Sankey.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/GridLine.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/Heat.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/Scatter3d.js","packages/superset-ui-legacy-plugin-chart-api-table/src/vis/Vis.js","packages/superset-ui-legacy-plugin-chart-api-table/src/ApiTable.jsx","controls/Controls.jsx","packages/superset-ui-plugins-demo/main.jsx","App.js","serviceWorker.js","index.js"],"names":["Funnel","props","useEffect","undefined","data","length","draw","labels","subLabels","colors","values","direction","FunnelGraph","container","gradientDirection","width","height","displayPercent","columns","map","col","dataIndex","slice","Object","keys","k","forEach","one_row_for_values","parseInt","push","Content","className","style","backgroundColor","Fragment","classes","bar","position","display","Bar","barDefaultStyle","transition","timeout","prevStyle","posDefaultStyle","marginTop","barTransitionStyles","entering","entered","currStyle","exiting","posTransitionStyles","Transition","in","state","label","textBoxStyle","value","barChart","BarChart","React","Component","constructor","super","this","barHeight","barStyle","nItmes","maxItems","barChartStyle","sortAxis","initRank","maxVal","idx","prevRank","currRank","started","start","update","bind","getInfoFromRank","componentDidMount","intervalId","setInterval","delay","setState","componentDidUpdate","prevProps","componentWillUnmount","clearInterval","timeline","prevState","i","descending","toSort","name","val","sort","left","right","Math","max","apply","item","reduce","ret","currIdx","prevIdx","render","timelineStyle","hidden","key","res","Array","fill","_","floor","random","BarRace","console","log","t","v","times_set","Set","d","add","times","from","key_series_data","indexOf","textAlign","color","len","fontSize","marginBottom","borderRadius","genTooltipsFormatterStr","e","first","second","third","cols","Sankey","source","target","nodes","nodes_list","links","tooltip","formatter","n","mychart","echarts","document","getElementById","option","title","subtext","series","type","top","bottom","layoutIterations","params","lineStyle","curveness","itemStyle","borderColor","fontFamily","trigger","setOption","id","GridLine","grids","xAxes","yAxes","titles","count","each","easingFunc","x","y","show","borderWidth","shadowColor","shadowBlur","min","gridIndex","xAxisIndex","yAxisIndex","showSymbol","animationEasing","animationDuration","text","textStyle","fontWeight","rowNumber","ceil","sqrt","grid","parseFloat","concat","xAxis","yAxis","Heat","columns_without_index","ydata","xdata","dt","c","toolbox","feature","dataZoom","restore","saveAsImage","animation","nameTextStyle","axisLine","splitArea","axisLabel","interval","rotate","visualMap","calculable","orient","inRange","inrange_color","emphasis","Scatter3d","row","graph2d","upleft","upright","downleft","downright","getDimType","grid3D","xAxis3D","yAxis3D","zAxis3D","boundaryGap","dataset","dimensions","symbolSize","encode","z","Vis","moment","locale","ButtonGroup","Button","Group","FormItem","Form","Item","Option","Select","Components","DatePicker","MonthPicker","RangePicker","WeekPicker","ApiTable","date","dataSource","controls","isError","loading","expand","searchText","drawerVisible","vis","formRef","createRef","getRequest","getData","setDataSource","onSearchSubmit","OnReset","getControls","getAntdColumns","getAntdDataSource","OnToggle","OnDownload","onTableSearch","onTableReset","showDrawer","onDrawerClose","externalApiService","current","validateFields","then","externalApiParam","isUpdateControls","presetParam","isForce","isPreset","requests","assign","mode","includes","resetFields","wb","xlsx","utils","book_new","ws","json_to_sheet","header","book_append_sheet","writeFile","format","compression","selectedKeys","confirm","clearFilters","url","window","location","search","theRequest","strs","substr","split","decodeURI","transferUrl","csrfToken","entries","isMoment","fetch","method","credentials","headers","Accept","Connection","body","JSON","stringify","Response","json","result","catch","error","getColumnSearchProps","filterDropdown","setSelectedKeys","padding","ref","node","searchInput","placeholder","onChange","onPressEnter","onClick","icon","SearchOutlined","size","marginRight","filterIcon","filtered","onFilter","record","toString","toLowerCase","onFilterDropdownVisibleChange","visible","setTimeout","select","children","controlsArray","itemArray","indexArray","gutter","md","lg","xl","index","CustomTag","CustomID","CustomLabel","options","opt1","opt2","filter","s","obj","propsAll","defaultValue","xs","sm","initialValue","antdCol","colWidth","toPrecision","temp","String","args","prototype","call","arguments","replace","match","number","action","href","rel","andtdDataSource","tablerow","zhCN","layout","onFinish","valuePropName","checkedChildren","unCheckedChildren","htmlType","disabled","ToolOutlined","CloudDownloadOutlined","BarChartOutlined","CaretUpOutlined","CaretDownOutlined","message","el","antdTable","overflowY","pagination","pageSizeOptions","showSizeChanger","showQuickJumper","showTotal","total","bordered","scroll","placement","forceRender","innerWidth","closable","onClose","getContainer","drawerStyle","destroyOnClose","Controls","handleKeyDown","keyCode","triggerChange","handleServicesChange","clearTimeout","timer","handleParamChange","addonBefore","onKeyDown","MainDemo","handleChange","App","Boolean","hostname","ReactDOM","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.2e2ae152.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\nimport FunnelGraph from 'funnel-graph-js';\nimport 'funnel-graph-js/dist/css/main.min.css';\nimport 'funnel-graph-js/dist/css/theme.min.css';\n\nconst Funnel = (props) => {\n  useEffect(() => {\n    if (props.data !== undefined && props.data.length !== 0) {\n      const draw = (labels, subLabels, colors, values, direction) => {\n        var graph = new FunnelGraph({\n          container: '.funnel',\n          gradientDirection: 'horizontal',\n          width: 1200,\n          height: 300,\n          data: {\n            labels: labels,\n            subLabels: subLabels,\n            // colors: colors,\n            values: values,\n          },\n          displayPercent: true,\n          direction: direction,\n        });\n        graph.draw();\n      };\n\n      const labels = props.columns.map((col) => col.dataIndex).slice(1); // 去掉第一个subLabel分组字段\n      // console.log('labels', labels)\n      const subLabels = Object.keys(props.data).map(\n        (k) => props.data[k][props.columns.map((col) => col.dataIndex)[0]]\n      );\n      // console.log('subLabels', subLabels)\n      const colors = [\n        ['#FFB178', '#FF78B1', '#FF3C8E'],\n        ['#A0BBFF', '#EC77FF'],\n        ['#A0F9FF', '#7795FF'],\n      ];\n      const values = [\n        // [3500, 2500, 6500],\n        // [3300, 1400, 1000],\n        // [600, 200, 130]\n      ];\n      const direction = 'horizontal';\n      labels.forEach((col) => {\n        let one_row_for_values = props.data.map((k) => parseInt(k[col]));\n        values.push(one_row_for_values);\n      });\n      draw(labels, subLabels, colors, values, direction);\n    }\n  }, [props]);\n\n  const Content = () => {\n    if (props.data) {\n      return (\n        <div className='funnel' style={{ backgroundColor: '#393862' }}></div>\n      );\n    } else {\n      return <React.Fragment></React.Fragment>;\n    }\n  };\n\n  return (\n    <React.Fragment>\n      <Content />\n    </React.Fragment>\n  );\n};\n\nexport default Funnel;\n","import React from 'react';\nimport { Transition } from 'react-transition-group'\n\nconst classes = {\n    bar: {\n        position: \"relative\",\n    },\n    container: {\n        width: \"100%\",\n        display: \"flex\",\n        position: \"absolute\",\n    }\n}\n\nfunction Bar(props) {\n    const barDefaultStyle = {\n        transition: `all ${props.timeout}ms ease-in-out`,\n        ...props.prevStyle,\n      };\n      const posDefaultStyle = {\n        transition: `all ${props.timeout}ms ease-in-out`,\n        marginTop: props.prevStyle.marginTop,\n      }\n      const barTransitionStyles = {\n          entering: props.prevStyle,\n          entered:  props.currStyle,\n          exiting: props.currStyle,\n      };\n      const posTransitionStyles = {\n          entering: {marginTop: props.prevStyle.marginTop},\n          entered: {marginTop: props.currStyle.marginTop},\n          exiting: {marginTop: props.currStyle.marginTop},\n      }\n      return (\n          <div style={classes.container}>\n            <Transition in={true} timeout={props.timeout}>\n                { \n                state => (\n                <React.Fragment>\n                <div style={{\n                    ...posDefaultStyle, \n                    ...posTransitionStyles[state],\n                    width: `${props.width[0]}%`\n                }}>\n                    {props.label}\n                </div>\n                <div style={{width: `${props.width[1]}%`}}>\n                    <div\n                        style={{\n                            ...classes.bar, \n                            ...barDefaultStyle, \n                            ...barTransitionStyles[state]}} \n                    />\n                </div>\n                <div style={{\n                    ...posDefaultStyle, \n                    ...posTransitionStyles[state],\n                    width: `${props.width[2]}%`\n                }}>\n                    <div style={{...props.textBoxStyle}}>\n                        {props.value}\n                    </div>\n                </div>\n                </React.Fragment>)\n                }\n            </Transition>\n          </div>\n        );\n}\n\nexport default Bar;","import React from 'react';\nimport Bar from './Bar';\n\nconst classes = {\n  barChart: {\n    width: '100%',\n    position: 'relative',\n  },\n  container: {\n    width: '100%',\n  },\n};\nclass BarChart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.barHeight = `calc(${props.barStyle.height} + ${props.barStyle.marginTop})`;\n    this.nItmes = Object.keys(this.props.data).length;\n    this.maxItems =\n      props.maxItems <= this.nItmes ? props.maxItems : this.nItmes;\n    this.barChartStyle = {\n      height: `calc(${this.maxItems} * ${this.barHeight})`,\n    };\n    let [initRank, maxVal] = this.sortAxis(0);\n    this.state = {\n      idx: 0,\n      prevRank: initRank,\n      currRank: initRank,\n      maxVal: maxVal,\n      started: props.start,\n    };\n\n    this.update = this.update.bind(this);\n    this.sortAxis = this.sortAxis.bind(this);\n    this.getInfoFromRank = this.getInfoFromRank.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.props.start) {\n      var intervalId = setInterval(\n        this.update,\n        this.props.timeout + this.props.delay\n      );\n      this.setState({ intervalId: intervalId });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.start && !prevProps.start) {\n      var intervalId = setInterval(\n        this.update,\n        this.props.timeout + this.props.delay\n      );\n      this.setState({ intervalId: intervalId });\n    }\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.state.intervalId);\n  }\n\n  update() {\n    if (this.state.idx + 1 === this.props.timeline.length) {\n      clearInterval(this.state.intervalId);\n      return;\n    }\n    this.setState((prevState) => {\n      let [currRank, maxVal] = this.sortAxis(prevState.idx + 1);\n      return {\n        idx: prevState.idx + 1,\n        prevRank: prevState.currRank,\n        currRank: currRank,\n        maxVal: maxVal,\n      };\n    });\n  }\n\n  sortAxis(i, descending) {\n    if (descending === undefined) descending = true;\n    let toSort = Object.keys(this.props.data).map((name) => {\n      return {\n        name: name,\n        val: this.props.data[name][i],\n      };\n    });\n    toSort.sort((left, right) =>\n      descending\n        ? left.val < right.val\n          ? 1\n          : left.val > right.val\n          ? -1\n          : 0\n        : left.val < right.val\n        ? 1\n        : left.val < right.val\n        ? -1\n        : 0\n    );\n    toSort = toSort.slice(0, this.maxItems);\n    const maxVal = Math.max.apply(\n      Math,\n      toSort.map((item) => item.val)\n    );\n    return [\n      toSort.reduce(\n        (ret, item, idx) => ({\n          ...ret,\n          ...{ [item.name]: idx },\n        }),\n        {}\n      ),\n      maxVal,\n    ];\n  }\n\n  getInfoFromRank(name) {\n    const currIdx = this.state.idx;\n    const prevIdx = currIdx > 0 ? currIdx - 1 : 0;\n    const value = this.props.data[name][currIdx];\n    const hidden = this.state.currRank[name] === undefined;\n    const currStyle = {\n      ...this.props.barStyle,\n      marginTop: `calc(${this.state.currRank[name]} * ${this.barHeight})`,\n      width: `${(100 * this.props.data[name][currIdx]) / this.state.maxVal}%`,\n      backgroundColor: this.props.colors[name],\n    };\n    const prevStyle = {\n      ...this.props.barStyle,\n      marginTop: `calc(${this.state.prevRank[name]} * ${this.barHeight})`,\n      width: `${(100 * this.props.data[name][prevIdx]) / this.state.maxVal}%`,\n      backgroundColor: this.props.colors[name],\n    };\n    return [value, hidden, currStyle, prevStyle];\n  }\n\n  render() {\n    return (\n      <div style={classes.container}>\n        <div style={this.props.timelineStyle}>\n          {this.props.timeline[this.state.idx]}\n        </div>\n        <div style={{ ...classes.barChart, ...this.barChartStyle }}>\n          {Object.keys(this.props.data).map((name) => {\n            const [value, hidden, currStyle, prevStyle] = this.getInfoFromRank(\n              name\n            );\n            if (hidden) return <div key={name}></div>;\n            return (\n              <Bar\n                name={name}\n                value={value}\n                label={this.props.labels[name]}\n                currStyle={currStyle}\n                prevStyle={prevStyle}\n                key={name}\n                timeout={this.props.timeout}\n                textBoxStyle={this.props.textBoxStyle}\n                width={this.props.width}\n              />\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default BarChart;\n","const data = ['apple', '中文', 'orange','shanghai','beijing','hangzhou','深圳'].reduce((res, item) => ({...res, ...{[item]: Array(20).fill(0).map(_ => Math.floor(20 * Math.random()))}}), {});\n\nexport default data;","import React, { useEffect } from 'react';\nimport BarChart from './BarRace/BarChart';\nimport data from './BarRace/data';\n\nconst randomColor = () => {\n    return `rgb(${255 * Math.random()}, ${255 * Math.random()}, ${255})`;\n}\n\n\n// const time = Array(20).fill(0).map((itm, idx) => idx + 1);\n\n// console.log('data', data)   // 省份分组唯一序列\n// console.log('time', time)   // 月份唯一排序\n// console.log('colors', colors) // 随机\n\nconst BarRace = props => {\n\n    console.log('props.data', props.data)\n    console.log('props.columns', props.columns)\n\n    const k = props.columns[0][\"dataIndex\"] // key column\n    const t = props.columns[1][\"dataIndex\"] // time column\n    const v = props.columns[2][\"dataIndex\"] // value column\n    console.log('k', k)\n    console.log('t', t)\n    console.log('v', v)\n\n    let times_set = new Set()\n    props.data.forEach(d => {\n        times_set.add(d[t])\n    })\n\n    let times = Array.from(times_set)\n\n    let key_series_data = {}\n\n    props.data.forEach(d => {\n        if (d[k] in key_series_data) {\n            const idx = times.indexOf(d[t])\n            key_series_data[d[k]][idx] = d[v]\n        } else {\n            key_series_data[d[k]] = new Array(times.length).fill(0)\n        }\n    });\n\n    console.log('key_series_data', key_series_data)\n    const keys = Object.keys(key_series_data);\n    const labels = keys.reduce((res, item, idx) => {\n        return {\n            ...res,\n            ...{\n                [item]: (\n                    <div style={{ textAlign: \"center\", }}>\n                        <div style={{ color: \"#ffffff\" }}>{item}</div>\n                    </div>\n                )\n            }\n        }\n    }, {});\n    const len = data[Object.keys(data)[0]].length;\n    const colors = keys.reduce((res, item) => ({\n        ...res,\n        ...{ [item]: randomColor() }\n    }), {});\n\n    return <div className=\"container\">\n        <BarChart\n            start={true}\n            data={key_series_data}\n            timeline={times}\n            labels={labels}\n            colors={colors}\n            len={len}\n            timeout={1000}\n            delay={150}\n            timelineStyle={{\n                textAlign: \"center\",\n                fontSize: \"80px\",\n                color: \"#ffffff\",\n                marginBottom: \"100px\"\n            }}\n            textBoxStyle={{\n                textAlign: \"right\",\n                color: \"#ffffff\",\n                fontSize: \"30px\",\n            }}\n            barStyle={{\n                height: \"60px\",\n                marginTop: \"10px\",\n                borderRadius: \"2px\",\n            }}\n            width={[15, 75, 10]}\n            maxItems={25}\n        />\n    </div>\n}\n\nexport default BarRace\n\n","import React, { useEffect } from 'react'\n// import echarts from 'echarts/lib/echarts';\nimport * as echarts from 'echarts';\n\nconst randomColor = () => {\n    return `rgb(${255 * Math.random()}, ${255 * Math.random()}, ${255})`;\n}\n\nconst genTooltipsFormatterStr = (e, first, second, third, cols) => {\n    let res = `${e[first]} > ${e[second]} <br />\n        ${cols[2]}: ${e[third]} <br />\n        `\n    for (let i = 3; i < cols.length; i++) {\n        res += `${cols[i]}: ${e[cols[i]]} <br />`\n    }\n\n    return res\n}\n\nconst Sankey = props => {\n    useEffect(() => {\n        if (props.data !== undefined && props.data.length !== 0) {\n\n\n            const columns = props.columns.map(col => col.dataIndex)\n\n            const source = columns[0]\n            const target = columns[1]\n            const value = columns[2]\n\n\n            let nodes = new Set()\n            let nodes_list = []\n            let links = []\n\n            props.data.forEach(e => {\n                nodes.add(e[source])\n                nodes.add(e[target])\n                links.push(\n                    {\n                        \"source\": e[source],\n                        \"target\": e[target],\n                        \"value\": e[value],\n                        tooltip: { formatter: genTooltipsFormatterStr(e, source, target, value, columns) }\n                    }\n                )\n            });\n\n            nodes.forEach(n => {\n                let color = randomColor()\n                nodes_list.push({\n                    \"name\": n,\n                    \"itemStyle\": {\n                        \"normal\": {\n                            \"color\": color,\n                            \"borderColor\": color\n                        }\n                    }\n                })\n\n            })\n\n            var mychart = echarts.init(document.getElementById('sankey'))\n            console.log('nodes_list', nodes_list)\n            console.log('linkes', links)\n            let option = {\n                title: {\n                    subtext: props.title,\n                    left: 'center'\n                },\n                // backgroundColor: \"\",\n                series: [\n                    {\n                        type: \"sankey\",\n                        left: 50.0,\n                        top: 20.0,\n                        right: 150.0,\n                        bottom: 25.0,\n                        layoutIterations: (props.params ? props.params.layoutIterations : 1),\n                        data: nodes_list,\n                        links: links,\n                        lineStyle: {\n                            color: \"source\",\n                            curveness: 0.5\n                        },\n                        itemStyle: {\n                            color: \"#1f77b4\",\n                            borderColor: \"#1f77b4\"\n                        },\n                        label: {\n                            // color: \"rgba(0,0,0,0.7)\",\n                            color: \"#ffffff\",\n                            fontFamily: \"Arial\",\n                            fontSize: 15\n                        },\n                        tooltip: {\n                            formatter: '{b} {c}',\n                        }\n                    }],\n                tooltip: {\n                    trigger: \"item\"\n                }\n            }\n\n            mychart.setOption(option)\n        }\n    }, [props])\n\n\n    return <div id=\"sankey\" style={{ width: '100%', height: 1000, backgroundColor: '#393862' }}></div>\n}\n\nexport default Sankey","import React, { useEffect } from 'react'\nimport * as echarts from 'echarts';\n\n// const randomColor = () => {\n//     return `rgb(${255 * Math.random()}, ${255 * Math.random()}, ${255})`;\n// }\n\nconst GridLine = props => {\n    useEffect(() => {\n        if (props.data !== undefined && props.data.length !== 0) {\n\n            const columns = props.columns.map(col => col.dataIndex)\n\n            const source = columns[0]\n            const target = columns[1]\n            const value = columns[2]\n\n            let nodes = new Set()\n            let nodes_list = []\n            let links = []\n\n            props.data.forEach(e => {\n                nodes.add(e[source])\n                nodes.add(e[target])\n                links.push(\n                    {\n                        \"source\": e[source],\n                        \"target\": e[target],\n                        \"value\": e[value]\n                    }\n                )\n            });\n            var easingFuncs = {\n                // 积极对待: function(k){\n                //     return 1/k\n                // }\n            };\n\n            var N_POINT = 30;\n\n            var grids = [];\n            var xAxes = [];\n            var yAxes = [];\n            var series = [];\n            var titles = [];\n            var count = 0;\n            echarts.util.each(easingFuncs, function (easingFunc, name) {\n                console.log('name', name)\n                var data = [];\n                for (var i = 0; i <= N_POINT; i++) {\n                    var x = i / N_POINT;\n                    var y = easingFunc(x);\n                    data.push([x, y]);\n                }\n                grids.push({\n                    show: false,\n                    borderWidth: 0,\n                    backgroundColor: '#393862',\n                    shadowColor: 'rgba(0, 0, 0, 0.3)',\n                    shadowBlur: 22\n                });\n                xAxes.push({\n                    type: 'value',\n                    show: false,\n                    min: 0,\n                    max: 1,\n                    gridIndex: count\n                });\n                yAxes.push({\n                    type: 'value',\n                    show: false,\n                    min: -0.4,\n                    max: 1.4,\n                    gridIndex: count\n                });\n                series.push({\n                    name: name,\n                    type: 'line',\n                    xAxisIndex: count,\n                    yAxisIndex: count,\n                    data: data,\n                    showSymbol: false,\n                    animationEasing: \"bounceOut\",\n                    animationDuration: 5000,\n                    color: \"#ffffff\"\n                });\n                titles.push({\n                    textAlign: 'center',\n                    text: name,\n                    textStyle: {\n                        fontSize: 12,\n                        fontWeight: 'normal',\n                        color: '#ffffff'\n                    }\n                });\n                count++;\n            });\n\n            var rowNumber = Math.ceil(Math.sqrt(count));\n            echarts.util.each(grids, function (grid, idx) {\n                grid.left = ((idx % rowNumber) / rowNumber * 100 + 0.5) + '%';\n                grid.top = (Math.floor(idx / rowNumber) / rowNumber * 100 + 0.5) + '%';\n                grid.width = (1 / rowNumber * 100 - 1) + '%';\n                grid.height = (1 / rowNumber * 100 - 1) + '%';\n\n                titles[idx].left = parseFloat(grid.left) + parseFloat(grid.width) / 2 + '%';\n                titles[idx].top = parseFloat(grid.top) + '%';\n            });\n\n            var mychart = echarts.init(document.getElementById('GridLine'))\n            let option = {\n                title: titles.concat([{\n                    text: props.title,\n                    top: 'bottom',\n                    left: 'center',\n                    textStyle: { color: '#393862' }\n                }]),\n                grid: grids,\n                xAxis: xAxes,\n                yAxis: yAxes,\n                series: series\n            };\n\n            mychart.setOption(option)\n        }\n    }, [props])\n\n\n    return <div id=\"GridLine\" style={{ width: '100%', height: 1000, backgroundColor: '#393862' }}></div>\n}\n\nexport default GridLine ","import React, { useEffect } from 'react'\nimport * as echarts from 'echarts'\n\nconst Heat = props => {\n    useEffect(() => {\n\n        var mychart = echarts.init(document.getElementById('heat'))\n        const columns = props.columns.map(col => col.dataIndex)\n        const columns_without_index = columns.slice(1)// remove index columns\n        var ydata = columns_without_index;\n        var xdata = columns_without_index;\n        let data = []\n\n        props.data.forEach((dt, x) => {\n            columns_without_index.forEach((c, y) => {\n                data.push([x, y, dt[c]])\n            }\n            )\n        })\n\n        let option = {\n            tooltip: {\n                position: 'top'\n            },\n            toolbox: {\n                feature: {\n                    dataZoom: {\n                        yAxisIndex: 'none'\n                    },\n                    restore: {},\n                    saveAsImage: {\n                        backgroundColor: '#393862'\n                    }\n                }\n            },\n            animation: false,\n            grid: {\n                height: '80%',\n                left: '13%',\n                top: '5%',\n                //backgroundColor:'white'\n            },\n            xAxis: {\n                name: 'x',\n                nameTextStyle: {\n                    // padding: [0, 0, -60, -245],    //the position of text \n                    color: 'white'\n                },\n                type: 'category',\n                data: xdata,\n                // textStyle: {\n                //     color: 'white'\n                // },\n                axisLine: {\n                    lineStyle: {\n                        color: '#fff'\n                    }\n                },\n                splitArea: {         // background split area if no data you can see it\n                    show: true,\n                    color: 'white'\n                },\n                axisLabel: {\n                    interval: 0,\n                    rotate: 50\n                }\n\n            },\n            yAxis: {\n                name: 'y',\n                nameTextStyle: {\n                    // padding: [0, 0, -210, -80], //the position of text\n                    color: 'white'\n                },\n                type: 'category',\n                data: ydata,\n                axisLine: {\n                    lineStyle: {\n                        color: '#fff'\n                    }\n                },\n                axisLabel: {\n                    interval: 0,\n                }\n                // splitArea: {\n                //     show: false\n                // }\n            },\n            visualMap: {\n                min: -1,\n                max: 1,\n                // align: 'left',\n                textStyle: { color: 'white' },\n                calculable: true,\n                orient: 'vertical',\n                left: '90%',\n                top: '35%',\n                // top: 'auto',    \n                //right: '10%',\n                inRange: {\n                    // color: ['#fff', '#330033']\n                    // color: ['navy','white' ,'salmon']\n                    color: props.params && props.params.inrange_color ? props.params.inrange_color : ['navy', 'white', 'salmon']\n                }\n            },\n            series: [{\n                name: columns[0],\n                type: 'heatmap',\n                data: data,\n                label: {\n                    show: false,\n                    color: 'white'\n                },\n                emphasis: {\n                    itemStyle: {\n                        shadowBlur: 10,\n                        shadowColor: 'white'\n                    },\n                }\n            }]\n        };\n        mychart.setOption(option)\n    }, [props])\n\n    return <div id=\"heat\" style={{ width: '100%', height: 1000, backgroundColor: '#393862' }}></div>\n}\n\nexport default Heat","import React, { useEffect } from 'react'\nimport * as echarts from 'echarts'\nimport echartsGL from 'echarts-gl' // don't remove \n\nconst Scatter3d = props => {\n    useEffect(() => {\n\n        const columns = props.columns.map(col => col.dataIndex)\n\n        var mychart = echarts.init(document.getElementById('scatter3d'))\n        let data = []\n        let row = []\n        props.data.forEach((d) => {\n            columns.forEach((c) => {\n                row.push(d[c])\n            })\n            data.push(row)\n            row = []\n        })\n        var sizeValue = '57%';\n        var symbolSize = 8.5;\n\n\n        // [[first_graph_x, first_graph_y],...]\n        \n        let graph2d = [[columns[0], columns[1]], [columns[0], columns[2]], [columns[0], columns[3]], [columns[2], columns[3]]]\n\n        if(props.params){\n            graph2d = [props.params.upleft, props.params.upright, props.params.downleft, props.params.downright]\n        }\n\n        const getDimType = (name) => {\n            if (typeof props.data[1][name] == \"string\") return 'category'\n            return 'value'\n        }\n\n        // typeof graph2d[0][0]] ? \"string\" : 'category'\n\n\n        let option = {\n            tooltip: {},\n            grid3D: {\n                width: '65%'\n            },\n            xAxis3D: { name: columns[2] },\n            yAxis3D: { name: columns[1] },\n            zAxis3D: { name: columns[0] },\n            grid: [\n                { left: '50%', width: '20%', bottom: sizeValue },\n                { left: '75%', width: '20%', bottom: sizeValue },\n                { left: '50%', width: '20%', top: sizeValue },\n                { left: '75%', width: '20%', top: sizeValue }\n            ],\n            xAxis: [\n                { type: getDimType(graph2d[0][0]), gridIndex: 0, name: graph2d[0][0], axisLabel: { rotate: 50, interval: 0 } },\n                { type: getDimType(graph2d[1][0]), gridIndex: 1, name: graph2d[1][0], boundaryGap: false, axisLabel: { rotate: 50, interval: 0 } },\n                { type: getDimType(graph2d[2][0]), gridIndex: 2, name: graph2d[2][0], axisLabel: { rotate: 50, interval: 0 } },\n                { type: getDimType(graph2d[3][0]), gridIndex: 3, name: graph2d[3][0], axisLabel: { rotate: 50, interval: 0 } }\n            ],\n            yAxis: [\n                { type: getDimType(graph2d[0][1]), gridIndex: 0, name: graph2d[0][1] },\n                { type: getDimType(graph2d[1][1]), gridIndex: 1, name: graph2d[1][1] },\n                { type: getDimType(graph2d[2][1]), gridIndex: 2, name: graph2d[2][1] },\n                { type: getDimType(graph2d[3][1]), gridIndex: 3, name: graph2d[3][1] }\n            ],\n            dataset: {\n                // dimensions: [\n                //     'Income',\n                //     'Life Expectancy',\n                //     'Population',\n                //     'Country',\n                //     { name: 'Year', type: 'ordinal' }\n                // ],\n                dimensions: columns,\n                source: data\n            },\n            series: [\n                {\n                    type: 'scatter3D',\n                    symbolSize: 7,\n                    encode: {\n                        x: columns[2],\n                        y: columns[1],\n                        z: columns[0],\n                        tooltip: [0, 1, 2, 3, 4]\n                    }\n                },\n\n                {\n                    type: 'scatter',\n                    symbolSize: symbolSize,\n                    xAxisIndex: 0,\n                    yAxisIndex: 0,\n                    encode: {\n                        x: graph2d[0][0],\n                        y: graph2d[0][1],\n                        tooltip: [0, 1, 2, 3, 4]\n                    }\n                },\n                {\n                    type: 'scatter',\n                    symbolSize: symbolSize,\n                    xAxisIndex: 1,\n                    yAxisIndex: 1,\n                    encode: {\n                        x: graph2d[1][0],\n                        y: graph2d[1][1],\n                        tooltip: [0, 1, 2, 3, 4]\n                    }\n                },\n                {\n                    type: 'scatter',\n                    symbolSize: symbolSize,\n                    xAxisIndex: 2,\n                    yAxisIndex: 2,\n                    encode: {\n                        x: graph2d[2][0],\n                        y: graph2d[2][1],\n                        tooltip: [0, 1, 2, 3, 4]\n                    }\n                },\n                {\n                    type: 'scatter',\n                    symbolSize: symbolSize,\n                    xAxisIndex: 3,\n                    yAxisIndex: 3,\n                    encode: {\n                        x: graph2d[3][0],\n                        y: graph2d[3][1],\n                        tooltip: [0, 1, 2, 3, 4]\n                    }\n                }\n            ]\n        };\n        mychart.setOption(option)\n    }, [props])\n\n    return <div id=\"scatter3d\" style={{ width: '100%', height: 1000, backgroundColor: '#fff' }}></div>\n}\n\nexport default Scatter3d ","import React from 'react';\nimport Funnel from './Funnel';\nimport BarRace from './BarRace';\nimport Sankey from './Sankey';\nimport GridLine from './GridLine';\nimport Heat from './Heat';\nimport Scatter3d from './Scatter3d';\n\nconst Vis = (props) => {\n  if (props.type === 'funnel') {\n    return (\n      <Funnel\n        data={props.data}\n        columns={props.columns}\n        title={props.title}\n        params={props.params}\n      />\n    );\n  } else if (props.type === 'bar_race') {\n    return (\n      <BarRace\n        data={props.data}\n        columns={props.columns}\n        title={props.title}\n        params={props.params}\n      />\n    );\n  } else if (props.type === 'sankey') {\n    return (\n      <Sankey\n        data={props.data}\n        columns={props.columns}\n        title={props.title}\n        params={props.params}\n      />\n    );\n  } else if (props.type === 'gridline') {\n    return (\n      <GridLine\n        data={props.data}\n        columns={props.columns}\n        title={props.title}\n        params={props.params}\n      />\n    );\n  } else if (props.type === 'heat') {\n    return (\n      <Heat\n        data={props.data}\n        columns={props.columns}\n        title={props.title}\n        params={props.params}\n      />\n    );\n  } else if (props.type === 'scatter3d') {\n    return (\n      <Scatter3d\n        data={props.data}\n        columns={props.columns}\n        title={props.title}\n        params={props.params}\n      />\n    )\n\n  }\n\n  return <React.Fragment>'vis type not exists'</React.Fragment>;\n};\n\nexport default Vis;\n","import React from 'react';\nimport {\n  ConfigProvider,\n  Form,\n  Row,\n  Col,\n  Input,\n  DatePicker,\n  Alert,\n  Table,\n  Select,\n  Button,\n  Switch,\n  Drawer,\n} from 'antd';\nimport {\n  BarChartOutlined,\n  SearchOutlined,\n  CloudDownloadOutlined,\n  ToolOutlined,\n  CaretUpOutlined,\n  CaretDownOutlined,\n} from '@ant-design/icons';\n// 由于 antd 组件的默认文案是英文，所以需要修改为中文\nimport zhCN from 'antd/es/locale/zh_CN';\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nimport 'antd/dist/antd.css';\nimport xlsx from 'xlsx';\nimport './ApiTable.css';\n\nimport Vis from './vis/Vis';\nmoment.locale('zh-cn');\n\nconst ButtonGroup = Button.Group;\nconst FormItem = Form.Item;\nconst { Option } = Select;\n\nconst Components = {\n  DatePicker,\n  MonthPicker: DatePicker.MonthPicker,\n  RangePicker: DatePicker.RangePicker,\n  WeekPicker: DatePicker.WeekPicker,\n  Select,\n};\n\nclass ApiTable extends React.Component {\n  // https://ant.design/components/form-cn/#components-form-demo-control-ref\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      date: '',\n      dataSource: [],\n      controls: [],\n      columns: [],\n      isError: null,\n      loading: false,\n      expand: true,\n      searchText: '',\n      drawerVisible: false,\n      vis: null,\n    };\n\n    this.formRef = React.createRef();\n\n    this.getRequest = this.getRequest.bind(this);\n    this.getData = this.getData.bind(this);\n    this.setDataSource = this.setDataSource.bind(this);\n    this.onSearchSubmit = this.onSearchSubmit.bind(this);\n    this.OnReset = this.OnReset.bind(this);\n    this.getControls = this.getControls.bind(this);\n    this.getAntdColumns = this.getAntdColumns.bind(this);\n    this.getAntdDataSource = this.getAntdDataSource.bind(this);\n    this.OnToggle = this.OnToggle.bind(this);\n    this.OnDownload = this.OnDownload.bind(this);\n    this.onTableSearch = this.onTableSearch.bind(this);\n    this.onTableReset = this.onTableReset.bind(this);\n    this.showDrawer = this.showDrawer.bind(this);\n    this.onDrawerClose = this.onDrawerClose.bind(this);\n  }\n\n  componentDidMount() {\n    const { externalApiService } = this.props;\n    this.formRef.current.validateFields().then((values) => {\n      // console.log('Form值: ', values);\n      this.getData(externalApiService, values, true);\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    const { externalApiParam, externalApiService } = this.props;\n    if (prevProps.externalApiParam !== externalApiParam) {\n      this.getData(externalApiService, { name: externalApiParam }, true);\n    }\n  }\n\n  // TODO:考虑二次查询的逻辑\n  setDataSource(data, isUpdateControls) {\n    const { dataSource, columns, controls, vis } = data;\n    // console.log('data', data)\n    if (isUpdateControls) {\n      const { externalApiService, externalApiParam } = this.props;\n      const presetParam = { name: externalApiParam, isForce: false };\n      let isPreset = false;\n      let requests = this.getRequest();\n\n      for (let i = 0; i < controls.length; i++) {\n        // 收集默认值=======\n        if ('value' in controls[i].props) {\n          isPreset = true;\n          Object.assign(presetParam, {\n            [controls[i].id]: controls[i].props.value,\n          });\n        }\n\n        // 根据URL参数和控件类型设置控件值=======\n        if (\n          // 使用id或者label属性均可\n          controls[i].id in requests ||\n          (controls[i].label && controls[i].label in requests)\n        ) {\n          if (controls[i].type === 'Select') {\n            // 目前只处理选择器\n            if (\n              controls[i].props.mode &&\n              ['multiple', 'tags'].includes(controls[i].props.mode)\n            ) {\n              controls[i].props.value = [\n                controls[i].id in requests\n                  ? requests[controls[i].id]\n                  : requests[controls[i].label],\n              ];\n            } else {\n              controls[i].props.value =\n                controls[i].id in requests\n                  ? requests[controls[i].id]\n                  : requests[controls[i].label];\n            }\n          }\n        }\n      }\n\n      this.setState({\n        controls,\n        dataSource,\n        columns,\n        vis,\n        loading: false,\n      });\n\n      // 存在默认值则进行二次查询，且不更新控件\n      if (isPreset) {\n        Object.assign(presetParam, requests);\n        this.getData(externalApiService, presetParam);\n      }\n    } else {\n      this.setState({\n        dataSource,\n        columns,\n        vis,\n        loading: false,\n      });\n    }\n  }\n\n  showDrawer() {\n    this.setState({\n      drawerVisible: true,\n    });\n  }\n\n  onDrawerClose() {\n    this.setState({\n      drawerVisible: false,\n    });\n  }\n\n  onSearchSubmit(values) {\n    const { externalApiService, externalApiParam } = this.props;\n    this.getData(externalApiService, { ...values, name: externalApiParam });\n  }\n\n  OnReset() {\n    this.formRef.current.resetFields();\n  }\n\n  OnToggle() {\n    const { expand } = this.state;\n    this.setState({ expand: !expand });\n  }\n\n  OnDownload() {\n    const { dataSource, columns } = this.state;\n\n    /* Generate Workbook */\n    const wb = xlsx.utils.book_new();\n    const ws = xlsx.utils.json_to_sheet(dataSource, {\n      header: columns.map((col) => col.title),\n    });\n    xlsx.utils.book_append_sheet(wb, ws, 'Sheet1');\n\n    // const elt = this.antdTable.getElementsByTagName('table')[0]\n    // const wb = xlsx.utils.table_to_book(elt, {sheet:\"Sheet JS\"});\n\n    /* Trigger Download with `writeFile` */\n    xlsx.writeFile(\n      wb,\n      `Superset Export ${moment().format('YYYY-MM-DD HH:mm:ss')}.xlsx`,\n      { compression: true }\n    );\n  }\n\n  onTableSearch(selectedKeys, confirm) {\n    confirm();\n    this.setState({ searchText: selectedKeys[0] });\n  }\n\n  onTableReset(clearFilters) {\n    clearFilters();\n    this.setState({ searchText: '' });\n  }\n\n  getRequest() {\n    const url = window.location.search; // 获取url中\"?\"符后的字串\n    let theRequest = {};\n\n    if (url.indexOf('?') !== -1) {\n      let str = url.substr(1);\n      let strs = str.split('&');\n      for (let i = 0; i < strs.length; i++) {\n        theRequest[decodeURI(strs[i].split('=')[0])] = decodeURI(\n          strs[i].split('=')[1]\n        );\n      }\n    }\n    return theRequest;\n  }\n\n  getData(transferUrl, params, isUpdateControls = false) {\n    this.setState({ loading: true, isError: null });\n    // console.log(transferUrl, params, isUpdateControls);\n    let csrfToken = document.getElementById('csrf_token');\n    csrfToken = csrfToken ? csrfToken.value : '';\n\n    // 更新 URL Param\n    Object.assign(params, this.getRequest());\n\n    // moment类型转化为字符串\n    for (const [key, value] of Object.entries(params)) {\n      if (moment.isMoment(value)) {\n        params[key] = value.format('YYYY-MM-DD HH:mm:ss');\n      } else if (value instanceof Array) {\n        if (moment.isMoment(value[0])) {\n          params[key] = value.map((item) => item.format('YYYY-MM-DD HH:mm:ss'));\n        }\n      }\n    }\n\n    fetch(transferUrl, {\n      method: 'POST', // *GET, POST, PUT, DELETE, etc.\n      mode: 'same-origin', // no-cors, cors, *same-origin\n      credentials: 'same-origin', // include, *same-origin, omit\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json; charset=utf-8',\n        // \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Connection: 'keep-alive',\n        'X-CSRF-TOKEN': csrfToken,\n      },\n      // redirect: \"follow\", // manual, *follow, error\n      // referrer: \"no-referrer\", // no-referrer, *client\n      body: JSON.stringify(params), // body data type must match \"Content-Type\" header\n    })\n      .then((Response) => Response.json())\n      .then((result) => this.setDataSource(result, isUpdateControls))\n      .catch((error) => {\n        this.setState({ isError: error, loading: false });\n      });\n  }\n\n  getColumnSearchProps(dataIndex) {\n    return {\n      filterDropdown: ({\n        setSelectedKeys,\n        selectedKeys,\n        confirm,\n        clearFilters,\n      }) => (\n        <div style={{ padding: 8 }}>\n          <Input\n            ref={(node) => {\n              this.searchInput = node;\n            }}\n            placeholder={`搜索 ${dataIndex}`}\n            value={selectedKeys[0]}\n            onChange={(e) =>\n              setSelectedKeys(e.target.value ? [e.target.value] : [])\n            }\n            onPressEnter={() => this.onTableSearch(selectedKeys, confirm)}\n            style={{ width: 188, marginBottom: 8, display: 'block' }}\n          />\n          <Button\n            type='primary'\n            onClick={() => this.onTableSearch(selectedKeys, confirm)}\n            icon={<SearchOutlined />}\n            size='small'\n            style={{ width: 90, marginRight: 8 }}\n          >\n            确定\n          </Button>\n          <Button\n            onClick={() => this.onTableReset(clearFilters)}\n            size='small'\n            style={{ width: 90 }}\n          >\n            重置\n          </Button>\n        </div>\n      ),\n      filterIcon: (filtered) => (\n        <SearchOutlined style={{ color: filtered ? '#1890ff' : undefined }} />\n      ),\n      onFilter: (value, record) =>\n        record[dataIndex]\n          ? record[dataIndex]\n              .toString()\n              .toLowerCase()\n              .includes(value.toLowerCase())\n          : false,\n      onFilterDropdownVisibleChange: (visible) => {\n        if (visible) {\n          setTimeout(() => this.searchInput.select());\n        }\n      },\n    };\n  }\n\n  getControls() {\n    const { controls, expand } = this.state;\n    let children = [];\n    if (controls) {\n      const controlsArray = [];\n      for (let i = 0; i <= controls.length; i = i + 3) {\n        controlsArray.push(controls.slice(i, i + 3));\n      }\n\n      const count = expand ? controlsArray.length : 1;\n\n      // 先渲染行，再渲染列\n      children = controlsArray.map((itemArray, indexArray) => (\n        <Row\n          key={indexArray}\n          gutter={{ md: 8, lg: 24, xl: 48 }}\n          style={{ display: indexArray < count ? 'flex' : 'none' }}\n        >\n          {itemArray.map((item, index) => {\n            const CustomTag = Components[`${item.type}`];\n            const CustomID = item.id;\n            const CustomLabel = item.label ? item.label : item.id;\n            const options = item.option\n              ? item.option\n                  .sort((opt1, opt2) => (opt1 < opt2 ? -1 : 1))\n                  .map((c) => (\n                    <Option key={c} value={c}>\n                      {c}\n                    </Option>\n                  ))\n              : null;\n\n            const props = item.props\n              ? Object.keys(item.props)\n                  .filter((s) => s !== 'value')\n                  .reduce((obj, key) => {\n                    obj[key] = item.props[key];\n                    return obj;\n                  }, {})\n              : null;\n\n            // 根据类型初始化\n            let value = null;\n            if (item.props) {\n              const propsAll = Object.keys(item.props);\n              if (item.type === 'RangePicker') {\n                props['showTime'] = {\n                  defaultValue: [\n                    moment('00:00:00', 'HH:mm:ss'),\n                    moment('23:59:59', 'HH:mm:ss'),\n                  ],\n                };\n                if (propsAll.includes('value') && propsAll.includes('format')) {\n                  value = [\n                    moment(item.props.value[0], item.props.format),\n                    moment(item.props.value[1], item.props.format),\n                  ];\n                }\n              } else if (\n                ['DatePicker', 'MonthPicker', 'WeekPicker'].includes(item.type)\n              ) {\n                props['showTime'] = {\n                  defaultValue: moment('00:00:00', 'HH:mm:ss'),\n                };\n                if (propsAll.includes('value') && propsAll.includes('format')) {\n                  value = moment(item.props.value, item.props.format);\n                }\n              } else {\n                if (propsAll.includes('value')) {\n                  value = item.props.value;\n                }\n              }\n            }\n\n            // https://stackoverflow.com/questions/31163693/how-do-i-conditionally-add-attributes-to-react-components\n            return (\n              <Col xs={20} sm={16} md={8} key={index}>\n                <FormItem\n                  name={`${CustomID}`}\n                  label={`${CustomLabel}`}\n                  {...(value ? { initialValue: value } : {})}\n                  // initialValue={value ? value : undefined}\n                  style={{ marginBottom: 12 }}\n                >\n                  <CustomTag\n                    {...props}\n                    // onChange={(...args) => { this.onSearchChange(item, ...args); }}\n                  >\n                    {options}\n                  </CustomTag>\n                </FormItem>\n              </Col>\n            );\n          })}\n        </Row>\n      ));\n    }\n    return children;\n  }\n\n  getAntdColumns(columns) {\n    let antdCol = [];\n    if (columns) {\n      const colWidth =\n        parseFloat(((1 / columns.length) * 100).toPrecision(12)) + '%';\n\n      for (let col of columns) {\n        let temp = {};\n        temp['dataIndex'] = col['dataIndex'];\n        temp['key'] = col['key'];\n        temp['title'] = col['title'];\n        temp['width'] = colWidth;\n        if ('render' in col && 'action' in col['render']) {\n          // 自定义format函数\n          if (!String.format) {\n            String.format = function (format) {\n              var args = Array.prototype.slice.call(arguments, 1);\n              return format.replace(/{(\\d+)}/g, function (match, number) {\n                return typeof args[number] != 'undefined'\n                  ? args[number]\n                  : match;\n              });\n            };\n          }\n          const url = col.render.action;\n          temp['render'] = (text, record, index) => (\n            <span>\n              <a\n                href={String.format(url, text)} // 暂只支持单个变量\n                target='_blank'\n                rel='noopener noreferrer'\n              >{`${text}`}</a>\n            </span>\n          );\n        }\n        // TODO：排序和筛选功能需要改进\n        temp['sorter'] = (opt1, opt2) => (opt1 < opt2 ? -1 : 1);\n        Object.assign(temp, this.getColumnSearchProps(col.dataIndex));\n        antdCol.push(temp);\n      }\n    }\n    return antdCol;\n  }\n\n  getAntdDataSource(dataSource) {\n    let andtdDataSource = [];\n    if (dataSource) {\n      andtdDataSource = dataSource.map((tablerow, index) =>\n        Object.assign({}, tablerow, { key: index })\n      );\n    }\n    return andtdDataSource;\n  }\n\n  render() {\n    const { externalApiParam } = this.props;\n\n    const { dataSource, columns, isError, loading, vis } = this.state;\n\n    // 隐藏字段名称为name，和RPC要求一致\n    return (\n      <ConfigProvider locale={zhCN}>\n        <div>\n          <Form\n            layout='vertical'\n            ref={this.formRef}\n            onFinish={this.onSearchSubmit}\n          >\n            {this.getControls()}\n            <Row>\n              <Col sm={24} style={{ textAlign: 'right' }}>\n                <FormItem\n                  name='name'\n                  initialValue={externalApiParam}\n                  style={{ marginBottom: 0 }}\n                >\n                  <Input type='hidden' />\n                </FormItem>\n                <FormItem\n                  name='isForce'\n                  initialValue={false}\n                  style={{\n                    marginBottom: 0,\n                    marginRight: 10,\n                  }}\n                  valuePropName='checked'\n                >\n                  <Switch checkedChildren='强刷' unCheckedChildren='缓存' />\n                </FormItem>\n                <ButtonGroup>\n                  <Button\n                    type='primary'\n                    icon={<SearchOutlined />}\n                    htmlType='submit'\n                    disabled={loading}\n                  >\n                    查询\n                  </Button>\n                  <Button icon={<ToolOutlined />} onClick={this.OnReset}>\n                    重置\n                  </Button>\n                  <Button\n                    icon={<CloudDownloadOutlined />}\n                    disabled={loading}\n                    onClick={this.OnDownload}\n                  >\n                    下载\n                  </Button>\n                  {vis ? (\n                    <Button\n                      type='secondary'\n                      icon={<BarChartOutlined />}\n                      disabled={loading}\n                      onClick={this.showDrawer}\n                    >\n                      可视化\n                    </Button>\n                  ) : (\n                    ''\n                  )}\n                </ButtonGroup>\n                <Button type='link' onClick={this.OnToggle}>\n                  {this.state.expand ? '收起' : '展开'}\n                  {this.state.expand ? (\n                    <CaretUpOutlined />\n                  ) : (\n                    <CaretDownOutlined />\n                  )}\n                </Button>\n              </Col>\n            </Row>\n          </Form>\n          {isError ? (\n            <div className='interactions'>\n              <Alert message='API调用错误' type='error' />\n            </div>\n          ) : (\n            <div\n              ref={(el) => (this.antdTable = el)}\n              style={{ marginTop: 20, height: '475px', overflowY: 'scroll' }}\n            >\n              <Table\n                dataSource={this.getAntdDataSource(dataSource)}\n                columns={this.getAntdColumns(columns)}\n                pagination={{\n                  pageSizeOptions: [\n                    '10',\n                    '20',\n                    '30',\n                    '40',\n                    `${dataSource.length}`,\n                  ],\n                  showSizeChanger: true,\n                  showQuickJumper: true,\n                  showTotal: (total) => `共 ${total} 行`,\n                }}\n                loading={loading}\n                bordered={true}\n                scroll={{ x: 360 }}\n                // scroll={true}\n                size='small'\n              />\n            </div>\n          )}\n        </div>\n        {vis ? (\n          <Drawer\n            title={vis.title}\n            placement='right'\n            forceRender={true}\n            width={window.innerWidth*0.75}\n            closable={true}\n            onClose={this.onDrawerClose}\n            visible={this.state.drawerVisible}\n            getContainer={true}\n            drawerStyle={{ position: 'absolute', backgroundColor: '#393862' }}\n            destroyOnClose\n          >\n            <Vis\n              data={dataSource}\n              columns={columns}\n              type={vis.type}\n              title={vis.title}\n              params={vis.params}\n            />\n          </Drawer>\n        ) : (\n          ''\n        )}\n      </ConfigProvider>\n    );\n  }\n}\n\nexport default ApiTable;\n","import React from 'react';\nimport { Divider, Input, Button, ConfigProvider } from 'antd';\nimport zhCN from 'antd/es/locale/zh_CN';\nimport 'antd/dist/antd.css';\n\nconst WAIT_INTERVAL = 2000;\nconst ENTER_KEY = 13;\n\nclass Controls extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      externalApiService: props.externalApiService,\n      externalApiParam: props.externalApiParam\n    };\n  }\n\n  handleKeyDown(e) {\n    if (e.keyCode === ENTER_KEY) {\n      this.triggerChange()\n    }\n  }\n\n  triggerChange() {\n    this.props.onChange(this.state)\n  }\n\n  handleServicesChange(e) {\n    clearTimeout(this.timer)\n    this.setState({ externalApiService: e.target.value })\n    this.timer = setTimeout(() => { this.triggerChange() }, WAIT_INTERVAL)\n  }\n\n  handleParamChange(e) {\n    clearTimeout(this.timer)\n    this.setState({ externalApiParam: e.target.value })\n    this.timer = setTimeout(() => { this.triggerChange() }, WAIT_INTERVAL)\n  }\n\n  render() {\n    return (\n      <ConfigProvider locale={zhCN}>\n        <div>\n          <Input\n            addonBefore='External API Service'\n            value={this.state.externalApiService}\n            onChange={(e) => this.handleServicesChange(e)\n            }\n            onKeyDown={(e) =>\n              this.handleKeyDown(e)\n            }\n\n          />\n          <Input\n            addonBefore='External API Parameters'\n            value={this.state.externalApiParam}\n            onChange={(e) => this.handleParamChange(e)\n            }\n            onKeyDown={(e) =>\n              this.handleKeyDown(e)\n            }\n          />\n        </div>\n      </ConfigProvider>\n    );\n  }\n}\n\nexport default Controls;\n","import React, { Component } from 'react';\nimport ApiTable from '../superset-ui-legacy-plugin-chart-api-table/src/ApiTable';\nimport '../superset-ui-legacy-plugin-chart-api-table/src/ApiTable.css';\nimport Controls from '../../controls/Controls';\n\nclass MainDemo extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      externalApiService: 'reports',\n      externalApiParam: 's_scatter3d_main',\n      // externalApiParam: 's_1001_main',\n    };\n  }\n\n  handleChange(s) {\n    this.setState(s);\n  }\n\n  render() {\n    return (\n      <div className='pannel-body'>\n        <Controls\n          externalApiService={this.state.externalApiService}\n          externalApiParam={this.state.externalApiParam}\n          onChange={(e) => this.handleChange(e)}\n        />\n        <ApiTable\n          externalApiService={this.state.externalApiService}\n          externalApiParam={this.state.externalApiParam}\n        />\n      </div>\n    );\n  }\n}\n\nexport default MainDemo;\n","import React, { Component } from 'react';\nimport './App.css';\nimport MainDemo from './packages/superset-ui-plugins-demo/main';\n\nclass App extends Component {\n  render() {\n    return (\n      <div className='App'>\n        <MainDemo />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}