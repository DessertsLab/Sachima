(this.webpackJsonpwaffle=this.webpackJsonpwaffle||[]).push([[0],{272:function(e,t,a){},286:function(e,t){},414:function(e,t,a){e.exports=a(904)},419:function(e,t,a){},420:function(e,t,a){},473:function(e,t){},474:function(e,t){},904:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(9),s=a.n(i),o=(a(419),a(420),a(390)),l=a(130),c=a(16),d=a(49),h=a(915),m=a(156),p=a(912),u=a(916),g=a(909),y=a(910),f=a(11),x=a(914),b=a(918),v=a(911),S=a(913),E=a(923),w=a(921),k=a(920),A=a(919),O=a(924),C=a(922),I=a(208),j=a(34),D=a.n(j),T=(a(468),a(273),a(157)),R=a.n(T),F=(a(272),a(406)),P=a.n(F);a(604),a(605);var M=e=>{Object(n.useEffect)(()=>{if(void 0!==e.data&&0!==e.data.length){const t=(e,t,a,n,r)=>{new P.a({container:".funnel",gradientDirection:"horizontal",width:1200,height:300,data:{labels:e,subLabels:t,values:n},displayPercent:!0,direction:r}).draw()},a=e.columns.map(e=>e.dataIndex).slice(1),n=Object.keys(e.data).map(t=>e.data[t][e.columns.map(e=>e.dataIndex)[0]]),r=[["#FFB178","#FF78B1","#FF3C8E"],["#A0BBFF","#EC77FF"],["#A0F9FF","#7795FF"]],i=[],s="horizontal";a.forEach(t=>{let a=e.data.map(e=>parseInt(e[t]));i.push(a)}),t(a,n,r,i,s)}},[e]);const t=()=>e.data?r.a.createElement("div",{className:"funnel",style:{backgroundColor:"#393862"}}):r.a.createElement(r.a.Fragment,null);return r.a.createElement(r.a.Fragment,null,r.a.createElement(t,null))},B=a(917);const z={bar:{position:"relative"},container:{width:"100%",display:"flex",position:"absolute"}};var H=function(e){const t=Object(c.a)({transition:"all ".concat(e.timeout,"ms ease-in-out")},e.prevStyle),a={transition:"all ".concat(e.timeout,"ms ease-in-out"),marginTop:e.prevStyle.marginTop},n={entering:e.prevStyle,entered:e.currStyle,exiting:e.currStyle},i={entering:{marginTop:e.prevStyle.marginTop},entered:{marginTop:e.currStyle.marginTop},exiting:{marginTop:e.currStyle.marginTop}};return r.a.createElement("div",{style:z.container},r.a.createElement(B.a,{in:!0,timeout:e.timeout},s=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:Object(c.a)(Object(c.a)(Object(c.a)({},a),i[s]),{},{width:"".concat(e.width[0],"%")})},e.label),r.a.createElement("div",{style:{width:"".concat(e.width[1],"%")}},r.a.createElement("div",{style:Object(c.a)(Object(c.a)(Object(c.a)({},z.bar),t),n[s])})),r.a.createElement("div",{style:Object(c.a)(Object(c.a)(Object(c.a)({},a),i[s]),{},{width:"".concat(e.width[2],"%")})},r.a.createElement("div",{style:Object(c.a)({},e.textBoxStyle)},e.value)))))};const _={barChart:{width:"100%",position:"relative"},container:{width:"100%"}};class V extends r.a.Component{constructor(e){super(e),this.barHeight="calc(".concat(e.barStyle.height," + ").concat(e.barStyle.marginTop,")"),this.nItmes=Object.keys(this.props.data).length,this.maxItems=e.maxItems<=this.nItmes?e.maxItems:this.nItmes,this.barChartStyle={height:"calc(".concat(this.maxItems," * ").concat(this.barHeight,")")};let t=this.sortAxis(0),a=Object(l.a)(t,2),n=a[0],r=a[1];this.state={idx:0,prevRank:n,currRank:n,maxVal:r,started:e.start},this.update=this.update.bind(this),this.sortAxis=this.sortAxis.bind(this),this.getInfoFromRank=this.getInfoFromRank.bind(this)}componentDidMount(){if(this.props.start){var e=setInterval(this.update,this.props.timeout+this.props.delay);this.setState({intervalId:e})}}componentDidUpdate(e){if(this.props.start&&!e.start){var t=setInterval(this.update,this.props.timeout+this.props.delay);this.setState({intervalId:t})}}componentWillUnmount(){clearInterval(this.state.intervalId)}update(){this.state.idx+1!==this.props.timeline.length?this.setState(e=>{let t=this.sortAxis(e.idx+1),a=Object(l.a)(t,2),n=a[0],r=a[1];return{idx:e.idx+1,prevRank:e.currRank,currRank:n,maxVal:r}}):clearInterval(this.state.intervalId)}sortAxis(e,t){void 0===t&&(t=!0);let a=Object.keys(this.props.data).map(t=>({name:t,val:this.props.data[t][e]}));a.sort((e,a)=>t?e.val<a.val?1:e.val>a.val?-1:0:e.val<a.val?1:e.val<a.val?-1:0),a=a.slice(0,this.maxItems);const n=Math.max.apply(Math,a.map(e=>e.val));return[a.reduce((e,t,a)=>Object(c.a)(Object(c.a)({},e),{[t.name]:a}),{}),n]}getInfoFromRank(e){const t=this.state.idx,a=t>0?t-1:0;return[this.props.data[e][t],void 0===this.state.currRank[e],Object(c.a)(Object(c.a)({},this.props.barStyle),{},{marginTop:"calc(".concat(this.state.currRank[e]," * ").concat(this.barHeight,")"),width:"".concat(100*this.props.data[e][t]/this.state.maxVal,"%"),backgroundColor:this.props.colors[e]}),Object(c.a)(Object(c.a)({},this.props.barStyle),{},{marginTop:"calc(".concat(this.state.prevRank[e]," * ").concat(this.barHeight,")"),width:"".concat(100*this.props.data[e][a]/this.state.maxVal,"%"),backgroundColor:this.props.colors[e]})]}render(){return r.a.createElement("div",{style:_.container},r.a.createElement("div",{style:this.props.timelineStyle},this.props.timeline[this.state.idx]),r.a.createElement("div",{style:Object(c.a)(Object(c.a)({},_.barChart),this.barChartStyle)},Object.keys(this.props.data).map(e=>{const t=this.getInfoFromRank(e),a=Object(l.a)(t,4),n=a[0],i=a[1],s=a[2],o=a[3];return i?r.a.createElement("div",{key:e}):r.a.createElement(H,{name:e,value:n,label:this.props.labels[e],currStyle:s,prevStyle:o,key:e,timeout:this.props.timeout,textBoxStyle:this.props.textBoxStyle,width:this.props.width})})))}}var L=V;var Y=["apple","\u4e2d\u6587","orange","shanghai","beijing","hangzhou","\u6df1\u5733"].reduce((e,t)=>Object(c.a)(Object(c.a)({},e),{[t]:Array(20).fill(0).map(e=>Math.floor(20*Math.random()))}),{});var W=e=>{console.log("props.data",e.data),console.log("props.columns",e.columns);const t=e.columns[0].dataIndex,a=e.columns[1].dataIndex,n=e.columns[2].dataIndex;console.log("k",t),console.log("t",a),console.log("v",n);let i=new Set;e.data.forEach(e=>{i.add(e[a])});let s=Array.from(i),o={};e.data.forEach(e=>{if(e[t]in o){const r=s.indexOf(e[a]);o[e[t]][r]=e[n]}else o[e[t]]=new Array(s.length).fill(0)}),console.log("key_series_data",o);const l=Object.keys(o),d=l.reduce((e,t,a)=>Object(c.a)(Object(c.a)({},e),{[t]:r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("div",{style:{color:"#ffffff"}},t))}),{}),h=Y[Object.keys(Y)[0]].length,m=l.reduce((e,t)=>Object(c.a)(Object(c.a)({},e),{[t]:"rgb(".concat(255*Math.random(),", ").concat(255*Math.random(),", ",255,")")}),{});return r.a.createElement("div",{className:"container"},r.a.createElement(L,{start:!0,data:o,timeline:s,labels:d,colors:m,len:h,timeout:1e3,delay:150,timelineStyle:{textAlign:"center",fontSize:"80px",color:"#ffffff",marginBottom:"100px"},textBoxStyle:{textAlign:"right",color:"#ffffff",fontSize:"30px"},barStyle:{height:"60px",marginTop:"10px",borderRadius:"2px"},width:[15,75,10],maxItems:25}))},K=a(52);const N=(e,t,a,n,r)=>{let i="".concat(e[t]," > ").concat(e[a]," <br />\n        ").concat(r[2],": ").concat(e[n]," <br />\n        ");for(let s=3;s<r.length;s++)i+="".concat(r[s],": ").concat(e[r[s]]," <br />");return i};var q=e=>(Object(n.useEffect)(()=>{if(void 0!==e.data&&0!==e.data.length){const a=e.columns.map(e=>e.dataIndex),n=a[0],r=a[1],i=a[2];let s=new Set,o=[],l=[];e.data.forEach(e=>{s.add(e[n]),s.add(e[r]),l.push({source:e[n],target:e[r],value:e[i],tooltip:{formatter:N(e,n,r,i,a)}})}),s.forEach(e=>{let t="rgb(".concat(255*Math.random(),", ").concat(255*Math.random(),", ",255,")");o.push({name:e,itemStyle:{normal:{color:t,borderColor:t}}})});var t=K.init(document.getElementById("sankey"));console.log("nodes_list",o),console.log("linkes",l);let c={title:{subtext:e.title,left:"center"},series:[{type:"sankey",left:50,top:20,right:150,bottom:25,layoutIterations:e.params?e.params.layoutIterations:1,data:o,links:l,lineStyle:{color:"source",curveness:.5},itemStyle:{color:"#1f77b4",borderColor:"#1f77b4"},label:{color:"#ffffff",fontFamily:"Arial",fontSize:15},tooltip:{formatter:"{b} {c}"}}],tooltip:{trigger:"item"}};t.setOption(c)}},[e]),r.a.createElement("div",{id:"sankey",style:{width:"100%",height:1e3,backgroundColor:"#393862"}}));var U=e=>(Object(n.useEffect)(()=>{if(void 0!==e.data&&0!==e.data.length){const c=e.columns.map(e=>e.dataIndex),d=c[0],h=c[1],m=c[2];let p=new Set,u=[];e.data.forEach(e=>{p.add(e[d]),p.add(e[h]),u.push({source:e[d],target:e[h],value:e[m]})});var t=[],a=[],n=[],r=[],i=[],s=0;K.util.each({},(function(e,o){console.log("name",o);for(var l=[],c=0;c<=30;c++){var d=c/30,h=e(d);l.push([d,h])}t.push({show:!1,borderWidth:0,backgroundColor:"#393862",shadowColor:"rgba(0, 0, 0, 0.3)",shadowBlur:22}),a.push({type:"value",show:!1,min:0,max:1,gridIndex:s}),n.push({type:"value",show:!1,min:-.4,max:1.4,gridIndex:s}),r.push({name:o,type:"line",xAxisIndex:s,yAxisIndex:s,data:l,showSymbol:!1,animationEasing:"bounceOut",animationDuration:5e3,color:"#ffffff"}),i.push({textAlign:"center",text:o,textStyle:{fontSize:12,fontWeight:"normal",color:"#ffffff"}}),s++}));var o=Math.ceil(Math.sqrt(s));K.util.each(t,(function(e,t){e.left=t%o/o*100+.5+"%",e.top=Math.floor(t/o)/o*100+.5+"%",e.width=1/o*100-1+"%",e.height=1/o*100-1+"%",i[t].left=parseFloat(e.left)+parseFloat(e.width)/2+"%",i[t].top=parseFloat(e.top)+"%"}));var l=K.init(document.getElementById("GridLine"));let g={title:i.concat([{text:e.title,top:"bottom",left:"center",textStyle:{color:"#393862"}}]),grid:t,xAxis:a,yAxis:n,series:r};l.setOption(g)}},[e]),r.a.createElement("div",{id:"GridLine",style:{width:"100%",height:1e3,backgroundColor:"#393862"}}));var G=e=>(Object(n.useEffect)(()=>{var t=K.init(document.getElementById("heat"));const a=e.columns.map(e=>e.dataIndex),n=a.slice(1);var r=n,i=n;let s=[];e.data.forEach((e,t)=>{n.forEach((a,n)=>{s.push([t,n,e[a]])})});let o={tooltip:{position:"top"},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{backgroundColor:"#393862"}}},animation:!1,grid:{height:"80%",left:"13%",top:"5%"},xAxis:{name:"x",nameTextStyle:{color:"white"},type:"category",data:i,axisLine:{lineStyle:{color:"#fff"}},splitArea:{show:!0,color:"white"},axisLabel:{interval:0,rotate:50}},yAxis:{name:"y",nameTextStyle:{color:"white"},type:"category",data:r,axisLine:{lineStyle:{color:"#fff"}},axisLabel:{interval:0}},visualMap:{min:-1,max:1,textStyle:{color:"white"},calculable:!0,orient:"vertical",left:"90%",top:"35%",inRange:{color:e.params&&e.params.inrange_color?e.params.inrange_color:["navy","white","salmon"]}},series:[{name:a[0],type:"heatmap",data:s,label:{show:!1,color:"white"},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"white"}}}]};t.setOption(o)},[e]),r.a.createElement("div",{id:"heat",style:{width:"100%",height:1e3,backgroundColor:"#393862"}}));a(903);var J=e=>(Object(n.useEffect)(()=>{const t=e.columns.map(e=>e.dataIndex);var a=K.init(document.getElementById("scatter3d"));let n=[],r=[];e.data.forEach(e=>{t.forEach(t=>{r.push(e[t])}),n.push(r),r=[]});let i=[[t[0],t[1]],[t[0],t[2]],[t[0],t[3]],[t[2],t[3]]];e.params&&(i=[e.params.upleft,e.params.upright,e.params.downleft,e.params.downright]);const s=t=>"string"==typeof e.data[1][t]?"category":"value";let o={tooltip:{},grid3D:{width:"65%"},xAxis3D:{name:t[2]},yAxis3D:{name:t[1]},zAxis3D:{name:t[0]},grid:[{left:"50%",width:"20%",bottom:"57%"},{left:"75%",width:"20%",bottom:"57%"},{left:"50%",width:"20%",top:"57%"},{left:"75%",width:"20%",top:"57%"}],xAxis:[{type:s(i[0][0]),gridIndex:0,name:i[0][0],axisLabel:{rotate:50,interval:0}},{type:s(i[1][0]),gridIndex:1,name:i[1][0],boundaryGap:!1,axisLabel:{rotate:50,interval:0}},{type:s(i[2][0]),gridIndex:2,name:i[2][0],axisLabel:{rotate:50,interval:0}},{type:s(i[3][0]),gridIndex:3,name:i[3][0],axisLabel:{rotate:50,interval:0}}],yAxis:[{type:s(i[0][1]),gridIndex:0,name:i[0][1]},{type:s(i[1][1]),gridIndex:1,name:i[1][1]},{type:s(i[2][1]),gridIndex:2,name:i[2][1]},{type:s(i[3][1]),gridIndex:3,name:i[3][1]}],dataset:{dimensions:t,source:n},series:[{type:"scatter3D",symbolSize:7,encode:{x:t[2],y:t[1],z:t[0],tooltip:[0,1,2,3,4]}},{type:"scatter",symbolSize:8.5,xAxisIndex:0,yAxisIndex:0,encode:{x:i[0][0],y:i[0][1],tooltip:[0,1,2,3,4]}},{type:"scatter",symbolSize:8.5,xAxisIndex:1,yAxisIndex:1,encode:{x:i[1][0],y:i[1][1],tooltip:[0,1,2,3,4]}},{type:"scatter",symbolSize:8.5,xAxisIndex:2,yAxisIndex:2,encode:{x:i[2][0],y:i[2][1],tooltip:[0,1,2,3,4]}},{type:"scatter",symbolSize:8.5,xAxisIndex:3,yAxisIndex:3,encode:{x:i[3][0],y:i[3][1],tooltip:[0,1,2,3,4]}}]};a.setOption(o)},[e]),r.a.createElement("div",{id:"scatter3d",style:{width:"100%",height:1e3,backgroundColor:"#fff"}}));var Q=e=>"funnel"===e.type?r.a.createElement(M,{data:e.data,columns:e.columns,title:e.title,params:e.params}):"bar_race"===e.type?r.a.createElement(W,{data:e.data,columns:e.columns,title:e.title,params:e.params}):"sankey"===e.type?r.a.createElement(q,{data:e.data,columns:e.columns,title:e.title,params:e.params}):"gridline"===e.type?r.a.createElement(U,{data:e.data,columns:e.columns,title:e.title,params:e.params}):"heat"===e.type?r.a.createElement(G,{data:e.data,columns:e.columns,title:e.title,params:e.params}):"scatter3d"===e.type?r.a.createElement(J,{data:e.data,columns:e.columns,title:e.title,params:e.params}):r.a.createElement(r.a.Fragment,null,"'vis type not exists'");D.a.locale("zh-cn");const X=d.a.Group,Z=h.a.Item,$=m.a.Option,ee={DatePicker:p.a,MonthPicker:p.a.MonthPicker,RangePicker:p.a.RangePicker,WeekPicker:p.a.WeekPicker,Select:m.a};class te extends r.a.Component{constructor(e){super(e),this.state={date:"",dataSource:[],controls:[],columns:[],isError:null,loading:!1,expand:!0,searchText:"",drawerVisible:!1,vis:null},this.formRef=r.a.createRef(),this.getRequest=this.getRequest.bind(this),this.getData=this.getData.bind(this),this.setDataSource=this.setDataSource.bind(this),this.onSearchSubmit=this.onSearchSubmit.bind(this),this.OnReset=this.OnReset.bind(this),this.getControls=this.getControls.bind(this),this.getAntdColumns=this.getAntdColumns.bind(this),this.getAntdDataSource=this.getAntdDataSource.bind(this),this.OnToggle=this.OnToggle.bind(this),this.OnDownload=this.OnDownload.bind(this),this.onTableSearch=this.onTableSearch.bind(this),this.onTableReset=this.onTableReset.bind(this),this.showDrawer=this.showDrawer.bind(this),this.onDrawerClose=this.onDrawerClose.bind(this)}componentDidMount(){const e=this.props.externalApiService;this.formRef.current.validateFields().then(t=>{this.getData(e,t,!0)})}componentDidUpdate(e){const t=this.props,a=t.externalApiParam,n=t.externalApiService;e.externalApiParam!==a&&this.getData(n,{name:a},!0)}setDataSource(e,t){const a=e.dataSource,n=e.columns,r=e.controls,i=e.vis;if(t){const e=this.props,t=e.externalApiService,s={name:e.externalApiParam,isForce:!1};let o=!1,l=this.getRequest();for(let a=0;a<r.length;a++)"value"in r[a].props&&(o=!0,Object.assign(s,{[r[a].id]:r[a].props.value})),(r[a].id in l||r[a].label&&r[a].label in l)&&"Select"===r[a].type&&(r[a].props.mode&&["multiple","tags"].includes(r[a].props.mode)?r[a].props.value=[r[a].id in l?l[r[a].id]:l[r[a].label]]:r[a].props.value=r[a].id in l?l[r[a].id]:l[r[a].label]);this.setState({controls:r,dataSource:a,columns:n,vis:i,loading:!1}),o&&(Object.assign(s,l),this.getData(t,s))}else this.setState({dataSource:a,columns:n,vis:i,loading:!1})}showDrawer(){this.setState({drawerVisible:!0})}onDrawerClose(){this.setState({drawerVisible:!1})}onSearchSubmit(e){const t=this.props,a=t.externalApiService,n=t.externalApiParam;this.getData(a,Object(c.a)(Object(c.a)({},e),{},{name:n}))}OnReset(){this.formRef.current.resetFields()}OnToggle(){const e=this.state.expand;this.setState({expand:!e})}OnDownload(){const e=this.state,t=e.dataSource,a=e.columns,n=R.a.utils.book_new(),r=R.a.utils.json_to_sheet(t,{header:a.map(e=>e.title)});R.a.utils.book_append_sheet(n,r,"Sheet1"),R.a.writeFile(n,"Superset Export ".concat(D()().format("YYYY-MM-DD HH:mm:ss"),".xlsx"),{compression:!0})}onTableSearch(e,t){t(),this.setState({searchText:e[0]})}onTableReset(e){e(),this.setState({searchText:""})}getRequest(){const e=window.location.search;let t={};if(-1!==e.indexOf("?")){let a=e.substr(1).split("&");for(let e=0;e<a.length;e++)t[decodeURI(a[e].split("=")[0])]=decodeURI(a[e].split("=")[1])}return t}getData(e,t,a=!1){this.setState({loading:!0,isError:null});let n=document.getElementById("csrf_token");n=n?n.value:"",Object.assign(t,this.getRequest());for(var r=0,i=Object.entries(t);r<i.length;r++){const e=Object(l.a)(i[r],2),a=e[0],n=e[1];D.a.isMoment(n)?t[a]=n.format("YYYY-MM-DD HH:mm:ss"):n instanceof Array&&D.a.isMoment(n[0])&&(t[a]=n.map(e=>e.format("YYYY-MM-DD HH:mm:ss")))}fetch(e,{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8",Connection:"keep-alive","X-CSRF-TOKEN":n},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>this.setDataSource(e,a)).catch(e=>{this.setState({isError:e,loading:!1})})}getColumnSearchProps(e){return{filterDropdown:({setSelectedKeys:t,selectedKeys:a,confirm:n,clearFilters:i})=>r.a.createElement("div",{style:{padding:8}},r.a.createElement(u.a,{ref:e=>{this.searchInput=e},placeholder:"\u641c\u7d22 ".concat(e),value:a[0],onChange:e=>t(e.target.value?[e.target.value]:[]),onPressEnter:()=>this.onTableSearch(a,n),style:{width:188,marginBottom:8,display:"block"}}),r.a.createElement(d.a,{type:"primary",onClick:()=>this.onTableSearch(a,n),icon:r.a.createElement(E.a,null),size:"small",style:{width:90,marginRight:8}},"\u786e\u5b9a"),r.a.createElement(d.a,{onClick:()=>this.onTableReset(i),size:"small",style:{width:90}},"\u91cd\u7f6e")),filterIcon:e=>r.a.createElement(E.a,{style:{color:e?"#1890ff":void 0}}),onFilter:(t,a)=>!!a[e]&&a[e].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:e=>{e&&setTimeout(()=>this.searchInput.select())}}}getControls(){const e=this.state,t=e.controls,a=e.expand;let n=[];if(t){const e=[];for(let a=0;a<=t.length;a+=3)e.push(t.slice(a,a+3));const i=a?e.length:1;n=e.map((e,t)=>r.a.createElement(g.a,{key:t,gutter:{md:8,lg:24,xl:48},style:{display:t<i?"flex":"none"}},e.map((e,t)=>{const a=ee["".concat(e.type)],n=e.id,i=e.label?e.label:e.id,s=e.option?e.option.sort((e,t)=>e<t?-1:1).map(e=>r.a.createElement($,{key:e,value:e},e)):null,o=e.props?Object.keys(e.props).filter(e=>"value"!==e).reduce((t,a)=>(t[a]=e.props[a],t),{}):null;let l=null;if(e.props){const t=Object.keys(e.props);"RangePicker"===e.type?(o.showTime={defaultValue:[D()("00:00:00","HH:mm:ss"),D()("23:59:59","HH:mm:ss")]},t.includes("value")&&t.includes("format")&&(l=[D()(e.props.value[0],e.props.format),D()(e.props.value[1],e.props.format)])):["DatePicker","MonthPicker","WeekPicker"].includes(e.type)?(o.showTime={defaultValue:D()("00:00:00","HH:mm:ss")},t.includes("value")&&t.includes("format")&&(l=D()(e.props.value,e.props.format))):t.includes("value")&&(l=e.props.value)}return r.a.createElement(y.a,{xs:20,sm:16,md:8,key:t},r.a.createElement(Z,Object.assign({name:"".concat(n),label:"".concat(i)},l?{initialValue:l}:{},{style:{marginBottom:12}}),r.a.createElement(a,o,s)))})))}return n}getAntdColumns(e){let t=[];if(e){const s=parseFloat((1/e.length*100).toPrecision(12))+"%";var a,n=Object(o.a)(e);try{for(n.s();!(a=n.n()).done;){let e=a.value,n={};if(n.dataIndex=e.dataIndex,n.key=e.key,n.title=e.title,n.width=s,"render"in e&&"action"in e.render){String.format||(String.format=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,a){return"undefined"!=typeof t[a]?t[a]:e}))});const t=e.render.action;n.render=(e,a,n)=>r.a.createElement("span",null,r.a.createElement("a",{href:String.format(t,e),target:"_blank",rel:"noopener noreferrer"},"".concat(e)))}n.sorter=(e,t)=>e<t?-1:1,Object.assign(n,this.getColumnSearchProps(e.dataIndex)),t.push(n)}}catch(i){n.e(i)}finally{n.f()}}return t}getAntdDataSource(e){let t=[];return e&&(t=e.map((e,t)=>Object.assign({},e,{key:t}))),t}render(){const e=this.props.externalApiParam,t=this.state,a=t.dataSource,n=t.columns,i=t.isError,s=t.loading,o=t.vis;return r.a.createElement(f.a,{locale:I.a},r.a.createElement("div",null,r.a.createElement(h.a,{layout:"vertical",ref:this.formRef,onFinish:this.onSearchSubmit},this.getControls(),r.a.createElement(g.a,null,r.a.createElement(y.a,{sm:24,style:{textAlign:"right"}},r.a.createElement(Z,{name:"name",initialValue:e,style:{marginBottom:0}},r.a.createElement(u.a,{type:"hidden"})),r.a.createElement(Z,{name:"isForce",initialValue:!1,style:{marginBottom:0,marginRight:10},valuePropName:"checked"},r.a.createElement(x.a,{checkedChildren:"\u5f3a\u5237",unCheckedChildren:"\u7f13\u5b58"})),r.a.createElement(X,null,r.a.createElement(d.a,{type:"primary",icon:r.a.createElement(E.a,null),htmlType:"submit",disabled:s},"\u67e5\u8be2"),r.a.createElement(d.a,{icon:r.a.createElement(w.a,null),onClick:this.OnReset},"\u91cd\u7f6e"),r.a.createElement(d.a,{icon:r.a.createElement(k.a,null),disabled:s,onClick:this.OnDownload},"\u4e0b\u8f7d"),o?r.a.createElement(d.a,{type:"secondary",icon:r.a.createElement(A.a,null),disabled:s,onClick:this.showDrawer},"\u53ef\u89c6\u5316"):""),r.a.createElement(d.a,{type:"link",onClick:this.OnToggle},this.state.expand?"\u6536\u8d77":"\u5c55\u5f00",this.state.expand?r.a.createElement(O.a,null):r.a.createElement(C.a,null))))),i?r.a.createElement("div",{className:"interactions"},r.a.createElement(b.a,{message:"API\u8c03\u7528\u9519\u8bef",type:"error"})):r.a.createElement("div",{ref:e=>this.antdTable=e,style:{marginTop:20,height:"475px",overflowY:"scroll"}},r.a.createElement(v.a,{dataSource:this.getAntdDataSource(a),columns:this.getAntdColumns(n),pagination:{pageSizeOptions:["10","20","30","40","".concat(a.length)],showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>"\u5171 ".concat(e," \u884c")},loading:s,bordered:!0,scroll:{x:360},size:"small"}))),o?r.a.createElement(S.a,{title:o.title,placement:"right",forceRender:!0,width:.75*window.innerWidth,closable:!0,onClose:this.onDrawerClose,visible:this.state.drawerVisible,getContainer:!0,drawerStyle:{position:"absolute",backgroundColor:"#393862"},destroyOnClose:!0},r.a.createElement(Q,{data:a,columns:n,type:o.type,title:o.title,params:o.params})):"")}}var ae=te;class ne extends r.a.Component{constructor(e){super(e),this.state={externalApiService:e.externalApiService,externalApiParam:e.externalApiParam}}handleKeyDown(e){13===e.keyCode&&this.triggerChange()}triggerChange(){this.props.onChange(this.state)}handleServicesChange(e){clearTimeout(this.timer),this.setState({externalApiService:e.target.value}),this.timer=setTimeout(()=>{this.triggerChange()},2e3)}handleParamChange(e){clearTimeout(this.timer),this.setState({externalApiParam:e.target.value}),this.timer=setTimeout(()=>{this.triggerChange()},2e3)}render(){return r.a.createElement(f.a,{locale:I.a},r.a.createElement("div",null,r.a.createElement(u.a,{addonBefore:"External API Service",value:this.state.externalApiService,onChange:e=>this.handleServicesChange(e),onKeyDown:e=>this.handleKeyDown(e)}),r.a.createElement(u.a,{addonBefore:"External API Parameters",value:this.state.externalApiParam,onChange:e=>this.handleParamChange(e),onKeyDown:e=>this.handleKeyDown(e)})))}}var re=ne;class ie extends n.Component{constructor(e){super(e),this.state={externalApiService:"reports",externalApiParam:"s_scatter3d_main"}}handleChange(e){this.setState(e)}render(){return r.a.createElement("div",{className:"pannel-body"},r.a.createElement(re,{externalApiService:this.state.externalApiService,externalApiParam:this.state.externalApiParam,onChange:e=>this.handleChange(e)}),r.a.createElement(ae,{externalApiService:this.state.externalApiService,externalApiParam:this.state.externalApiParam}))}}var se=ie;class oe extends n.Component{render(){return r.a.createElement("div",{className:"App"},r.a.createElement(se,null))}}var le=oe;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[414,1,2]]]);
//# sourceMappingURL=main.2e2ae152.chunk.js.map